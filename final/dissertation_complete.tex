\documentclass[a4paper,12pt]{report}
\usepackage[left=3cm,right=1.7cm,bottom=2cm,top=2.2cm]{geometry}

% Page and title setup
\usepackage{setspace}
\setstretch{2}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead[CO,CE]{\leftmark}
\fancyhead[LO,LE]{SOEE3058}
\fancyhead[RE,RO]{200695089}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\normalfont\bfseries\vspace{-4.0cm}}{}{0pt}{\Huge}
\setcounter{secnumdepth}{2}
\usepackage[toc,page]{appendix}

% font
\usepackage{charter}    

% references
\usepackage{natbib} 
\bibliographystyle{leedsHarvard}  
\renewcommand\bibname{References}
\usepackage[nottoc,numbib]{tocbibind}
  
% graphics and figures
\usepackage[font=it]{caption}
\usepackage{chngcntr}
\counterwithin{figure}{chapter}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{graphicx}
\graphicspath{{/nfs/see-fs-01_teaching/ee12lmb/project/doc/figures/}}
\usepackage{tabularx}
\usepackage{tabulary}
\setlength\extrarowheight{10pt}

% program listings
\usepackage{float}
\newfloat{program}{thpb}{lop}
\floatname{program}{Listing}

\usepackage{color}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\usepackage{listings}
\lstset{language=Matlab,basicstyle=\small,keywordstyle=\color{black}\bfseri
es\underbar,
%identifierstyle=\color{red},
stringstyle=\ttfamily,
showstringspaces=false,
numbers=left, stepnumber=1,numberstyle=\tiny\color{gray},
keywordstyle=\color{blue},
commentstyle=\color{dkgreen},
stringstyle=\color{mauve},
morekeywords={m_indexDisc,m_indexCont,j_index}}

% equations
\usepackage{mathtools}  
\numberwithin{equation}{chapter}

% title etc
\title{\textbf{The M-index: A useful metric for rock deformation?}}

\author{Student: Lewis Bailey\\Student number: 200695089\\Supervisor: Dr Andrew Walker}
\date{}


\begin{document}
% -----------    D o c u m e n t     ------------

\maketitle

\pagenumbering{roman}
\tableofcontents

\listoffigures
\listoftables

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction} \label{chap:intro}
\vspace{-1cm}
\pagenumbering{arabic}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%---------------------------------------------------------------------------
\section{Executive Summary} \label{sec:summary}
%---------------------------------------------------------------------------

%---------------------------------------------------------------------------
\section{Background and motivation} \label{sec:background}
%---------------------------------------------------------------------------
In a number geological settings on Earth, processes occur that cause rocks to deform in a ductile manner in reaction to external forces (stress). Ductile deformation of rocks on short time-scales generally requires stresses greatly exceeding those on Earth. However due to the polycrystalline nature of rocks, slow, permanent deformation is possible when stresses are maintained on geological time scales \citep{Weiss1985}. It is processes occurring at the crystal/grain scale, such as dislocation glide and dislocation creep that allow this deformation to take place, and the strain imposed to be accommodated \citep{Ashby1972}. These internal deformation mechanisms often result in the formation of crystallographic (or lattice) preferred orientations \citep{Price1985}. 

The study of textures and their strength has a number of applications in both industry and academia. Textures, or lattice preferred orientations (LPO) arise in rocks that have undergone ductile deformation. The properties of this LPO are dependant on the strain history, and in general increased strain leads to a \lq{}stronger\rq{} LPO \textbf{REF?}. If LPO strength can be quantified by a texture index, and this index can be reliably related to strain, then it could prove a useful tool in determining strain in situations where it is impossible to measure though conventional means.

This is especially applicable to mantle studies. Relating the formation and strength of textures in peridotites to shear strain is important, as this gives insight into how deformation mechanisms lead to seismic anisotropy \citep{Warren2008}. Understanding these processes is key in determining upper mantle convection through seismic anisotropy studies \citep[e.g.][]{Blackman2002}. A metric that can act as a proxy for texture strength would be beneficial to mantle studies, as most peridotites lack strain markers \citep{Tommasi2000}.

In addition to estimating strain from samples, texture indices could also offer a method of indirectly determining strain and other properties of textures via seismology. \cite{Tommasi1999} study the relationship between seismic anisotropy and LPO in continental deformation zones. They predict textures of olivine after undergoing various deformation types found in the mantle, and from this calculate the expected seismic anisotropy. If the remotely measured anisotropy can be related to texture strength (i.e. a texture index) and this index can be related to an amount of strain the material has experienced, it could provide at least an estimate of strain for remote regions of the Earth's interior. In essence this is the reverse of the processes used by \cite{Tommasi1999}. Although their study was applied to the mantle, seismic anisotropy due to LPO is known to exist in other regions of the Earth, and these have been studied using VPSC modelling \citep[e.g.][]{Wenk1999}.   

Aside from these general applications, a more direct motivation arises from \cite{Skemer}. After introducing their metric (the M-index) and applying it to olivine, they state that \lq\lq{}further research is necessary to confirm the M-index's validity or practicality for other materials\rq\rq{}, which gives clear scope for a project to investigate this. In order to confirm its validity, it is also necessary to compare the M-index with a number of other metrics in a similar fashion to \cite{Mainprice}, but with greater detail and for a number of crystal structures. This leads to the main aims and objectives of this study.   





%---------------------------------------------------------------------------
\section{Aims and objectives} \label{sec:aims+objs}
\noindent
\textbf{Aim:} to investigate a range of methods for determining the strength of rock texture.

\noindent	 
\textbf{Objectives;}
	\begin{itemize}
		\item Compile a suite of \texttt{Matlab} functions to compute the various methods of texture classification for a standardised input file. I will do this following coding principals \citep{Computing} using version control to keep track of the software development.
		\item Attempt to replicate some of \cite{Skemer} and \cite{Mainprice} for non-olivine samples to confirm or deny their observations are consistent across sample types.
		\item Calculate texture indexes for a range of samples and models and draw comparisons between the results. Determine the most robust and reliable method. Use texture strength as a proxy for shear strain and investigate correlations between this and the indexes calculated.
	\end{itemize}
	
	
The overarching aim of this study is to investigate a number of methods for quantifying the strength of textures in rocks, and if this quantisation 

The following chapter covers the necessary theory of textures in general such as descriptors of orientation, leading to the theory behind the indices themselves. Chapter \ref{chap:methods} begins by describing the available data sources and the methods of modelling/collecting this data. The rest of the chapter focuses on how the theory is implemented, using this data, via a suite of \texttt{Matlab} functions. As the software is an integral part of this project, details are given on a number of key functions, the use of the software, and important aspects of its development. Once the data and methodology are in place, chapter \ref{chap:analysis} contains the subsequent analysis of the indices. This analysis focuses on parameters affecting index calculation \emph{(index robustness)} and their relationship with strain \emph{(proxy for strain)}. Chapter \ref{chap:discussion} offers a discussion of the results presented in chapter \ref{chap:analysis} as well as suggestions for future work. Finally the findings of this study are summarised in chapter \ref{chap:conclusion}, followed by the reference list and appendices.   
%---------------------------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Theory} \label{chap:theory}
\vspace{-1cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The following sections aim to give enough theoretical knowledge of textures and the methods of computing texture strength, to allow understanding of the implementation and analysis that follows.


%---------------------------------------------------------------------------
\section{Textures in rocks} 
%---------------------------------------------------------------------------

%---------------------------------------------------------------------------
\section{Describing orientations} \label{sec:orientations}
%---------------------------------------------------------------------------
\emph{NB: The material in this section is covered by a number of textbooks on texture analysis, namely \cite{bunge1982texture}, \cite{Bunge1985} and \cite{Randle2000}}.




\subsection{Coordinate systems \& orientations} \label{subsec:coordinates}
The key principal behind describing the texture of a polycrystalline material is to be able to describe the orientations of the individual grains within it. In order to accomplish this two coordinates systems must be defined---one for the sample as a whole $(C_S)$ and one for any individual crystal within the sample $(C_C)$. Both systems should be Cartesian, with the directions of the axes usually chosen to best represent the important surfaces or directions within the sample to be studied. Once these two coordinate systems have been established, an orientation $(g)$ can then be defined to be a rotation that maps one coordinate system on to the other such that;



\begin{equation}
C_C\ =\ g \cdot C_S\ ,
\end{equation}  
\\
where in this case, the sample coordinate system is rotated to that of the crystal. The orientation $g$ can be described in a number of ways. The principal methods I will use are \emph{Euler angles} and \emph{rotation matrices}.


A set of Euler angles defines three rotations that transform the sample coordinate system onto the crystal coordinate system and so therefore specify an orientation. I will be using the conventions of \cite{bunge1982texture} such that the three rotations that make up the orientation are defined as $g = \{\varphi_1,\Phi,\varphi_2\}$. The angle $\varphi_1$ is the first rotation about the $Z$ axis, followed by a rotation $\Phi$ about the $X'$ axis in its new orientation, and finally $\varphi_2$ about the $Z''$ axis, in its final orientation (figure \ref{fig:euler_angles}). The order of these rotations is not interchangeable.




\begin{figure}[h!]
  \centering
    \includegraphics[width=0.6\textwidth]{euler_angles}
  \caption[Euler angle description]{Example of how the coordinate system of a sheet sample (here the $Z$ axis is in the normal direction ND and the $X$ axis is in the rolling direction RD) can be translated to that of the crystal coordinate system through three rotations $\varphi_1,\Phi,\varphi_2$. From \cite{Randle2000}.}
  \label{fig:euler_angles}
\end{figure}

Having established a method to describe an orientation (i.e. the rotation that maps sample to crystal coordinate systems or vice versa), so too can it describe a misorientation. A misorientation is defined as the rotation that maps one crystal's coordinate system onto another crystal's, rather than to the sample coordinate system (REF). This can be described for two orientations, $g_1$ and $g_2$ such that the misorientation between them $\tilde{g}$ is;

\begin{equation} \label{eq:misor_matrix}
\tilde{g} = g_1^{-1}g_2\ .
\end{equation} 

This notation for the misorientation becomes clearer with the introduction of an \emph{orientation matrix}. This is a nine element square rotation matrix constructed in the following way. Consider a crystal coordinate system $C_c = \{X_c,Y_c,Z_c\}$ and a sample coordinate system $C_s = \{X_s,Y_s,Z_s\}$. Then define angles between axes as follows;

\begin{table}[h!]
    \centering
	\begin{tabular}{c | c c c}

	  & $X_s$      & $Y_s$      & $Z_s$ \\
\hline
$X_c$ & $\alpha_1$ & $\beta_1$ & $\gamma_1$ \\
$Y_c$ & $\alpha_2$ & $\beta_2$ & $\gamma_2$ \\
$Z_c$ & $\alpha_3$ & $\beta_3$ & $\gamma_3$ \\

	\end{tabular}
\end{table}
\noindent
and so construct the matrix;

\begin{equation}
g = 
\begin{pmatrix}
g_{11} & g_{12} & g_{13} \\
g_{21} & g_{22} & g_{23} \\
g_{31} & g_{32} & g_{33} \\
\end{pmatrix}
= 
\begin{pmatrix}
cos \alpha_1 & cos \beta_1 & cos \gamma_1 \\
cos \alpha_2 & cos \beta_2 & cos \gamma_2 \\
cos \alpha_3 & cos \beta_3 & cos \gamma_3 \\
\end{pmatrix}\ .
\end{equation}
\\
This matrix is a useful tool in describing rotation and symmetry operations because the result of two or more rotations can be expressed by matrix multiplication (see APPENDIX DISORIENTATION REF?), adding clarity to the definition of the misorientation matrix defined in equation \ref{eq:misor_matrix}. Due to orthogonality $g^{-1} = g^T$. 


In addition to Euler angles and rotation matrices, another method for describing the orientation of a crystal, or indeed any number of crystals, in a sample is through the use of \emph{pole figures}. An orientation of an arbitrary crystal face (chosen to best represent the crystal structure) can be described by a vector normal to its surface. This vector, or pole, then corresponds to a point on a unit reference sphere centred on the crystal (figure \ref{fig:spherical_orientation}). The reference sphere is attached to the sample coordinate system, allowing two angles (the azimuth $\alpha$ and the rotation around the pole axis $\beta$) to represent the orientation of the crystal with respect to that frame.  




\begin{figure}[h!]
  \centering
    \includegraphics[width=0.6\textwidth]{pole_figure}
  \caption[Pole figure visualisation]{Orientation of the basal (0001) plane in a hexagonal crystal. Projecting the orientation on the reference sphere requires two angles, $\alpha$ and $\beta$. In this example, the crystal still has freedom to rotate about the 0001 axis, so more information is required (the $\mathit{10\overline{1}0}$ pole) to describe the orientation in three dimensions. From \cite{Randle2000}.}
  \label{fig:spherical_orientation}
\end{figure}



In order to represent this three dimensional orientation in two dimensions, these poles must be projected onto a two-dimensional plane --- this is done using either stereographic or equal-area projection (the latter most common in geology). By choosing an axis of the sample coordinate system to be the north pole (typically $Z$) so that $\alpha = 0^\circ$ requires the normal of the plane in question to be parallel to that axis. The poles can then be projected as in figure \ref{fig:pole_olivine_example}, which shows an example of pole figures for a simulated olivine sample. Here the density of poles is plotted as a colour intensity. The Miller indicies above the figures show which crystal axes are being considered for each relevant pole figure. In the case of olivine and its cubic crystal shape, the poles of three crystal faces are needed to unambiguously describe its orientation. Any less than this and the crystal has a degree of freedom to rotate about the relevant axes, as in Figure \ref{fig:spherical_orientation}. The number of poles required to unambiguously describe an orientation of a crystal will change depending on the crystal symmetry.




\begin{figure}[h]
  \centering
    \includegraphics[width=0.85\textwidth,trim={3.2cm 10cm 0 0},clip]{poles_olivine_example}
  \caption[Pole figure olivine example]{Example of pole figures for a modelled olivine sample. The Miller indices are displayed above the the lower hemisphere projections, with red colours indicating a higher density of poles plotted.}
  \label{fig:pole_olivine_example}
\end{figure}




A pole figure represents the orientation of the crystal coordinate system in the sample coordinate system, but the opposite can also be useful, this is known as the inverse pole figure. In addition to pole figures, other methods of describing orientations exist such as quaternions \citep{Quaternions}. However these are beyond the scope of this project. 




\subsection{Orientation distribution functions} \label{subsec:ODFs}
In order to perform quantitative analysis of a three dimensional texture in a sample, a two-dimensional pole figure does not contain enough information---a three-dimensional \emph{orientation distribution function} (ODF) is required. Unlike pole figures, ODFs cannot be measured experimentally, they must be calculated from pole figure data. Recalling that a pole direction can be defined by two angles $\alpha$ and $\beta$ in a pole figure $P_h(y)$, this then corresponds to a region in the ODF which contains all the rotations $\gamma$ about this direction $y$. This results in the following equation; 




\begin{equation} \label{eq:pole_figures}
P_h(y) = \frac{1}{2\pi} \cdot \int_{0}^{2\pi}f(g)\ \mathrm{d}\gamma;\ ,
\end{equation}
\\
where $f(g)$ is the ODF, with $g = \{\varphi_1,\Phi,\varphi_2\}$. In a similar way an inverse pole figure equation can also be derived. As pole figures are two-dimensional projections, multiple pole figures are needed in order to unambiguously describe the three-dimensional ODF \citep[and in fact it is only determined uniquely for an infinite number of pole figures,][]{Bunge1985}.



Solving this equation is known as pole figure inversion, for which no analytic solution exists. One method for approximating the ODF is through spherical harmonic series expansion, such that;




\begin{equation} \label{eq:series_exp}
f(g) = \sum_{l=0}^{l_{max}} \sum_{m=-l}^l \sum_{n=-l}^l C_l^{mn} T_l^{mn} (g) \ ,
\end{equation}
\\
where $T_l^{mn}$ are spherical harmonic functions and $C_l^{mn}$ are expansion coefficients to be determined. Full description of this method and other, more direct methods is beyond the scope of this project (for more general information see relevant chapters in \cite{bunge1982texture,Bunge1985} and \cite{Randle2000}, or for information regarding the methods used in this project see \cite{Hielscher2008}).



%Pole figure inversion deals with the practicality of obtaining an ODF from experimental pole figure data. However, \cite{bunge1982texture} offers a more intuitive description. If the spatial location of crystals are ignored, only their orientations $g = \{\varphi_1,\Phi,\varphi_2\}$ are considered Consider $\mathrm{d}V$ to be the volume of all crystals with orientation $g = \{\varphi_1,\Phi,\varphi_2\}$ within the infinitesimal volume element $\mathrm{d}g$ (in Euler space). It follows that;

Pole figure inversion deals with the practicality of obtaining an ODF from experimental pole figure data. However, \cite{bunge1982texture} offers a more intuitive description. Firstly the spatial location of the crystals in the sample can be disregarded, and only their orientations $g = \{\varphi_1,\Phi,\varphi_2\}$ are considered. The ODF can then be defined as the fraction of crystals \emph{of the same phase} that have the orientation $g$ within an infinitesimal orientation element $\mathrm{d}g$ (in Euler space) such that: 



\begin{equation}
\frac{\mathrm{d}V(g)}{V} = f(g)\ \mathrm{d}g\ ,
\end{equation}
\\
where $f(g)$ is the ODF, and $V$ is the total sample volume. \cite{Mainprice} state that a \emph{Mis}orientation Distribution Function (MDF) can be defined for a misorientation $\tilde{g}$ in a similar way;




\begin{equation}
\frac{\mathrm{d}V(\tilde{g})}{V} = f_{MDF}(\tilde{g})\ \mathrm{d}\tilde{g}\ ,
\end{equation}
\\
where $\mathrm{d}V(\tilde{g})/V$ is now the fraction of misorientations in the sample. In essence the ODF and MDF are statistical in nature as they are probablity density functions of orientations $g$ or misorientations $\tilde{g}$. 


%---------------------------------------------------------------------------
\section{Texture indices} \label{sec:indicies}
%---------------------------------------------------------------------------
Having established a mathematical way of describing the orientations of grains within a sample (the ODF/MDF, herein referred to indiscriminately as the texture function), the next step is to find a method of quantising the \lq{}sharpness\rq{} or strength of this function, and hence the strength of the texture.

\subsection{J-index} \label{subsec:j-index}
 One of the most widely used indicies is the texture index $(J)$, as described by \cite{bunge1982texture} to be the integral of the square of the texture function,

\begin{equation}
J = \int [ f(g) ]^2\ \mathrm{d}g \ ,
\end{equation} 
\\
where the infinitesimal volume element in Euler angle space $\mathrm{d}g$ is given by:

\begin{equation}
\mathrm{d}g = \frac{1}{8\pi^2} \sin\Phi\ \mathrm{d}\Phi\ \mathrm{d}\varphi_1\ \mathrm{d}\varphi_2\ .
\end{equation} 
\\
This definition is true for both $f_{ODF}$ and $f_{MDF}$, the difference only being the definition of $g$ (section \ref{subsec:coordinates}). The texture index $J$ is more removed from physical meaning than the M-index (see following section), but as the texture function $f(g)$ is a statistical representation of the physical texture, calculating the magnitude of this function (in this case the $L^2$ norm $||f||^2_{L^2}$) gives information about its overall strength.

To put the texture index in context it is useful to compare it to another measure, the entropy $S$ of the texture function:

\begin{equation}
S\ =\ -\int f(g)\ ln f(g)\ \mathrm{d}g\ ,
\end{equation}
\\
introduced by \cite{Schaeben1988}. The entropy essentially measures the deviation from the uniform ODF \citep[lack of \lq{}organisation\rq{} of orientations,][]{Hielscher2007}. Due to the $ln f(g)$, $S$ is sensitive to very small values of the texture function. In some sense, the texture index $J$ is the opposite of this, as it is a measure of concentration rather than dispersion of orientations. As it includes the square of the texture function $[f(g)]^2$, it is more sensitive to large values, (i.e. peaks) in the function \citep{Mainprice}. For more discussion on the relation between $J$ and $S$ see \cite{Hielscher2007}. 

By substituting the series expansion for the ODF (eq. \ref{eq:series_exp})  and normalising, \cite{bunge1982texture} was able to determine that for a random texture $J_r = 1$. In addition, if the sample is a perfect single crystal, then the texture changes at only one point $g = g_0$, which results in $J_{ideal} \to \infty$, leading to:

\begin{equation}
1 \leq J_{ODF} \leq \infty\ .
\end{equation}
\\
$J_{MDF}$ will not tend to $\infty$ but rather a maximum value \citep{Mainprice}.

In a nearly identical way, and by recalling the definition of pole figures (eq. \ref{eq:pole_figures}) the $J$ index for a pole figure can be defined as:
 
\begin{equation}
J_{P_h(y)} = \frac{1}{4\pi} \int [ P_{h}(y) ]^2\ dy\ ,
\end{equation}
\\
with the same holding true for inverse pole figures. By substituting in the series expansion for pole figures and through an integral calculus theorem \citep[p.90]{bunge1982texture} it can be shown that $J_{P_h(y)} \leq J$. This inequality makes sense physically in that the strength of texture in a pole figure cannot be greater than the strength of a texture as a whole, and can take a maximum value when the pole is aligned with the direction of the maximum texture. As this project focuses on a number of indices, to avoid confusion the texture index described in this section shall be referred to as the \emph{J-index}, as it is often denoted with the letter $J$.


\subsection{M-index} \label{subsec:Mindex}
A more empirical method to quantify texture strength is the M-index. Defined by \cite{Skemer}, the method is based on the difference between a measured misorientation angle distribution $f^M(\theta)$ and a random theoretic distribution $f^R(\theta)$ (calculated from the sample crystal symmetry). To understand the physical significance of this metric, it is first important to clearly define the misorientation angle between two crystals. Recalling the definition of a misorientation matrix $\tilde{g}$ (a 3 x 3 rotation matrix that rotates one crystal coordinate system onto another), a misorientation angle $\theta$ can be extracted from this matrix using the relation:

\begin{equation}
\cos{\theta}\ =\ \frac{(\tilde{g}_{11} + \tilde{g}_{22} + \tilde{g}_{33} - 1)}{2}\ .
\end{equation} 
\\
\citep{Randle2000}. This is the angle needed to rotate one coordinate system about some common axis of rotation in order for the two coordinate systems (and hence the two crystals) to be aligned. Figure \ref{fig:angle-axis_example} shows an example of how an angle/axis of rotation can describe a misorientation. A misorientation angle distribution is simply a histogram detailing the frequency density of misorientation angles within the sample (the rotation vector is unimportant, we require only the angle $\theta$). There are two types of misorientation angle distributions. A correlated MAD is where only the angles between neighbouring grains are considered, whereas in an uncorrelated MAD, angles between all pairs of crystals are considered.

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=0.6\textwidth]{axes_angle_rot_PPT.pdf}
  \caption[Angle/axis of rotation example]{Example of how an angle of rotation $\theta$ about a common axis \textbf{r} can translate one crystal onto another. For two cubes orientated such as this, the location and direction of the axis is obvious, but the vector \textbf{r} need not folow a crystal edge as in this example (and often will not). After \cite{Randle2000}.}
  \label{fig:angle-axis_example}
\end{figure}
%---------------------------FIG---------------------------------------------   

\cite{Skemer} define the M-index, in terms of \emph{continuous} misorientation angle distributions (i.e. derived statistically from a MDF) as:

\begin{equation} \label{eq:Mindex_cont}
M \equiv \frac{1}{2} \int | f^M(\theta) - f^R(\theta) |\ \mathrm{d}\theta \ .
\end{equation}  
\\   
The physical significance of this index is related to the change in individual misorientation angles within the sample as strain is increased. As strain increases in a sample and grains begin to align (i.e. texture strength increases), misorientation angles between any arbitrary pair of grains will become smaller, due to their coordinate systems being more closely aligned. This makes the M-index definition clearer: at low strains a sample texture will be close to that of the theoretical random texture and so the difference between their misorientation angle distributions (MAD) will be small. As strain increases, the sample MAD will favour lower angles, and the difference between them will become greater (and therefore the index value will be larger). This is demonstrated in figure \ref{fig:misorientation_example} showing distributions for an olivine VPSC model (see section \ref{sec:data}) undergoing simple shear at increasing strain steps.


%---------------------------FIG---------------------------------------------   
\begin{figure}[t]
  \centering
    \includegraphics[width=\textwidth]{figs/OLV_SPS_misor_example.pdf}
  \caption[Misorientation angle distribution example (olivine VPSC)]{Misorientation angle distribution for an olivine VPSC model undergoing simple shear. The solid black line represents the expected distribution for a random texture for reference. It is clear that as stain increases from panels \textbf{(a)} to \textbf{(d)} that there is a higher frequency of lower misorientation angles (due to the grains aligning) resulting in a greater difference between the sample distribution and the random distribution.}
  \label{fig:misorientation_example}
\end{figure}
%---------------------------FIG--------------------------------------------- 

In practice it is easier to calculate the M-index using the \emph{discrete} definition whereby the difference between the theoretic and random distribution is simply the difference between the histograms:

\begin{equation} \label{eq:Mindex_disc}
M \equiv \sum_{i=1}^n | f_i^M - f_i^R | \cdot \frac{\theta_{max}}{2n}\ ,
\end{equation} 
where the calculation is now for $n$ histogram bins and $\theta_{max}$ is the maximum theoretical misorientation angle for the specific crystal symmetry \citep[for discussion on misorientation angle distirbutions for various crystal symmetries see][and references therein]{Grimmer1979,Wheeler2001}. The factor of a half is for convenience to give the range $0 \leq M \leq 1$. 

  

\cite{Schaeben2007} offers some criticism of the theoretical validity and usefulness of the M-index. In particular he does not agree with the claim of \cite{Skemer} that the M-index provides a more robust and objective than the J-index. He argues that calculating index values by considering each orientation measurement as independent is statistically incorrect as the orientation measurements are spatially correlated. \cite{Skemer2007reply} have responded stating that the M-index is an alternative to the J-index and does not aim to replace it. Emphasis is placed on its use in Earth-sciences due to its apparent robustness at low numbers of measurements. Analysis of these claims by \cite{Skemer} and \cite{Skemer2007reply} forms part of the motivation for this work.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Data and Methods} \label{chap:methods}
\vspace{-1cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Now that the necessary theory has been established, the following sections provide a description of how the indices have been implemented. However, to understand the implementation it is important to first introduce the datasets from which the indices will be calculated.  

%---------------------------------------------------------------------------
\section{Data collection} \label{sec:data}
%---------------------------------------------------------------------------
The data in this project come from two sources; 1) numerical models of deformed polycrystalline aggregates and 2) direct texture measurements from physical specimens using electron backscatter diffraction. 

\subsection{VPSC modelling}
Viscoplastic self-consistent (VPSC) numerical modelling of LPO \citep{Molinari1987,Lebensohn1993} provides a very versatile dataset of textures to analyse. Using this technique, orientation data can be generated for a polycrystalline material with an entirely random texture, composed of crystals of a specified symmetry. This random texture can then be deformed in a number of ways (simple shear, axial compression etc.), the output of which is the set of Euler angles that describes the orientation of individual grains at time-steps throughout this designated deformation sequence (MAYBE FIG HERE?). Although a number of approaches exist to model polycrystalline deformation such as equilibrium based, purely kinematic or isotropic methods, VPSC is often used because of its robust physical assumptions and relatively quick computation \citep[][and references therein]{Tommasi2000}. 

Some key aspects that differentiate VPSC from other modelling regimes is that it accounts for plastic anisotropy (of both grain and matrix) as well as grain shape effects \citep[as introduced by][]{Lebensohn1993}. It differs from equilibrium based methods as microscopic stress and strain (i.e. for each grain) can vary, provided equilibrium is maintained at macroscopic scale \citep{Tommasi2000}. Effects of nearest neighbour interaction are not taken into account \citep[see][for details]{Castelnau1996}.

VPSC models were run by Dr Andrew Walker (University of Leeds) to provide a range of datasets as outlined in table \ref{tab:VPSC_data}. The output data file contains information such as the number of grains in the simulation and Euler angles for each grain, as well as the strain at each time step. This is the most useful aspect of VPSC modelling, as strain is always known accurately, which is often not the case for physical samples. However, one drawback is that as with any model, there will be elements of reality that are not accounted for and as such physical datasets are required for this project.

\begin{table} 
	\centering
	\caption[VPSC datasets]{Details of all datasets created using VPSC modelling. VPSC models ran by Dr Andrew Walker (University of Leeds).\\}
\begin{tabularx}{\textwidth}{X X X X}
	\hline
	\hline
	Crystal Type    & Deformation Type  & No. Grains & Name on Disk \\
	\hline
	\hline
	Olivine         & Axial Compression & 200        & *Needs completing *    \\
	Olivine         & Simple Shear      & 10,000     & *Needs completing*    \\
	Post-perovskite & Simple Shear      & 203,102    & *Needs completing*    \\
	\hline
	\end{tabularx}
\label{tab:VPSC_data}
\end{table}

\subsection{Electron backscatter diffraction}
Electron backscatter techniques have long been used to study various properties of crystals and polycrystalline materials. A number of methods have arisen to determine crystal orientation data using a scanning electron microscope (SEM), including electron channeling patterns and X-ray Kossel-line techniques. However, these have been generally surpassed by electron backscatter diffraction \citep[EBSD or backscatter Kikuchi diffraction,][]{Harland1973}.  In essence, an electron beam is fired at a steeply tilted crystalline sample (to decrease path length for backscattered electrons), which produces distinctive backscatter Kikuchi patterns. These patterns are captured by a phosphor screen and digitised by a camera, and can then be analysed by software to determine crystal orientation information from their geometry  \citep{Zaefferer2007}. By moving the beam over the sample, the orientation information of all grains can be determined. \cite{Prior1999} offer a thorough description of the EBSD technique, specifically it use for rock texture, e.g. sample preparation. Further discussion of the technique is beyond the scope of this project \citep[see][for more info]{Schwarzer1997,Randle2000}.    

Orientation data for a number of samples measured using EBSD were made available by \cite{ParsonsThesis}. The data are from the Annapurna-Dhaulagiri Himalaya, and provide samples with a range of strains that are qualitatively arranged in order from pole figure 1 (least strain) to pole figure 10 (most strain), composed predominately of quartz crystals (figure \ref{fig:EBSD_data}).. 

%---------------------------FIG---------------------------------------------   
\begin{figure}[h!]
  \centering
    \includegraphics[width=\textwidth]{EBSD_Pole_Figs.pdf}
  \caption[EBSD data (pole figures)]{A range of quartz c-axis CPO fabrics from the Annapurna-Dhaulagiri Himalaya. Contours shows multiples of uniform distribution. Maximum and minimum values of multiples of uniform distribution are next to each pole figure, with the sample number displayed beneath. The samples have been ordered qualitatively from the lowest strain (1) to the highest (10) by comparing pole figures with those in the literature. These pole figures and sample numbers represent the EBSD data that was used in this project \citep[made available from][]{ParsonsThesis}.}
  \label{fig:EBSD_data}
\end{figure}  
%---------------------------FIG---------------------------------------------   
    

%---------------------------------------------------------------------------
\section{Implementation}
%---------------------------------------------------------------------------

The following section provides a general overview as to how the data described in section \ref{sec:data} are combined with the theory outlined in chapter \ref{chap:theory} in order to calculate the texture indices and gain other useful information. One of the objectives of this study was to create a coherent and versatile suite of \texttt{Matlab} functions to study texture strength (a \emph{toolbox}), as opposed to writing \lq{}static\rq{} scripts that would function solely as part of this project. As a result, the functions are organised into three groups, which will be described over the following sections. Due to the considerable effort undertaken to create this toolbox, the final section describes the general coding practices and principles used, as well as outlining some important aspects of the development and use of the software. In some sense the toolkit is as much of a \lq{}result\rq{} of this project as the analysis of the texture indices that it enables. All source code is available from https://github.com/ee12lmb/matlabSource.                                                                                                     


\subsection{Additional software}
Before outlining the software that I have developed in this project, it is important to introduce two additional \texttt{Matlab} toolboxes which have provided integral functionality to my own code. In particular the \texttt{MTEX} texture analysis package\footnote{http://mtex-toolbox.github.io/} \citep{Bachmann2010,Mainprice} provided efficient ODF calculation from orientation data, raw EBSD file reading and other useful tools. Some of what I have done is to streamline and standardise these tools specifically for texture strength index calculations, in addition to writing my own methods. The \texttt{MSAT} seismic anisotropy toolbox\footnote{http://github.com/andreww/MSAT} was used to calculate the anisotropy measured used (see section REF).    

\subsection{Data input and sampling}

This group of functions (directory \lq{}readfiles\rq{} on disc, see table \ref{tab:read_functions}) deals with the input of orientation data from both VPSC models and EBSD data (in .ctf format). The functions \texttt{read\_{}VPSC} and \texttt{read\_{}EBSD} (derived from original code MVT\_{}read\_{}VPSC\_{}file.m by Andrew Walker\footnote{https://github.com/andreww/microtecm} and REF FOR EBSD respectively) will extract an array of Euler angles defining the orientation of the individual grains within the sample, as well as other metadata such as the number of grains, crystal symmetry (EBSD only) and number of strain steps (VPSC only).                                                

Building on this basic functionality, a useful tool is the ability to subsample from a larger dataset (i.e. extract $n$ random grains from a total of $N$ in the sample). In the context of this project this allows for analysis of the robustness of the indices (see section REF), but also statistical analysis and efficient index calculations. The functions \texttt{sample\_{}VPSC} and \texttt{sample\_{}EBSD} will sample directly from a file, while the function \texttt{sample\_{}texture} will do the same for an array of Euler angles already loaded into the \texttt{Matlab} environment. These functions take an input seed so that the same \lq{}random\rq{} samples can be generated to allow repeatability. Also included in this group are some internal functions such as \texttt{lookupSym} which returns an \texttt{MTEX} crystal symmetry object (REF) for a given crystal name (e.g. \lq{}olivine\rq{}) and \texttt{get\_{}inputInfo} which combines all of the functionality in this section into a compact form.                                                                                                                            

\begin{table}[h!] 
	\centering
	\caption[Functions: reading \& sampling]{Functions used for reading in and sampling either VPSC or EBSD data, finding crystal symmetries and other data related tasks.}
	\noindent
	
\begin{tabularx}{\textwidth}{lX}

\hline
\hline
Function    & Description   \\ 
\hline
\hline

\texttt{setup\_{}env} & Function initialises the \texttt{MTEX} package and adds paths to all other functions. Stores a global variable to indicate this has been completed (to prevent this occurring at each separate function call). \\  

\texttt{read\_{}VPSC} & Will extract Euler angles and strain information from VPSC files, if output in Bunge convention. If multiple strain steps are present their information will be stored in a cell array (edited from original code by Dr Andrew Walker). \\ 

\texttt{sample\_{}VPSC} & Loads data using \texttt{read\_{}VPSC} and then returns $n$ randomly sampled grains (without replacement). \\  

\texttt{read\_{}EBSD} & Similar to \texttt{read\_{}VPSC}, but reads in EBSD files (*.ctf format). \\

\texttt{sample\_{}EBSD} & Similal to \texttt{sample\_{}VPSC} but for EBSD files (*.ctf format). \\ 
\\
\hline
\hline

\end{tabularx}
\label{tab:read_functions}
\end{table}

\subsection{Index calculation} \label{sec:index_calc}

There are three index calculations available in this toolbox (each with their own directory on disk, see table \ref{tab:index_functions}). The function \texttt{j\_{}index} uses a number of tools provided in \texttt{MTEX} (REF),  such as \texttt{calcODF} which statistically calculates the orientation distribution function from the input Euler angles, and \texttt{textureindex} which calculates the J-index from this ODF \citep[for details on their method of ODF calculation see][]{Hielscher2008}. Similarly, \texttt{m\_{}indexCont} uses this ODF to calculate a \emph{statistical} misorientation distribution function (MDF) for the input Euler angles.  This MDF is then subtracted from the theoretical random MDF to give what I call the \emph{continuous M-index} (equation REF) due to its statistical nature.  Although much of the essential tools are derived from \texttt{MTEX}, both \texttt{j\_{}index} and \texttt{m\_{}indexCont} utilise the functionality described in the previous section in combination with consistent syntax in their use to streamline index calculation using a number of inputs and calculation parameters (e.g. the number of grains $n$ to use, see listing REF in section REF).         

The function \texttt{m\_{}indexDisc} is more involved in its calculation and only relies on \texttt{MTEX} to produce the theoretical misorientation angle distribution for a given symmetry (using \texttt{calcAngleDistribution}). As with the other index functions, \texttt{m\_{}indexDisc} takes either EBSD, VPSC or a list of Euler angles as input, as well as a number of input calculation parameters, using a consistent syntax (see listing REF). To find the misorientation angle distribution, I wrote the function \texttt{discreteMDF}, which finds the misorientation matrix ($\tilde{g}$, equation REF) between all combination of grains within the sample \citep[uncorrelated misorientation angle distribution,][]{Mainprice}. Each $\tilde{g}$ is passed to \texttt{calDisorientation}, a function I wrote that finds the disorientation \citep{Grimmer1979} by applying symmetry operators for the chosen crystal structure and choosing the smallest misorientation angle. Once these are found, \texttt{discreteMDF} returns a list of misorientation angles to \texttt{m\_{}indexDisc} which counts them in bins (the width of which is specified by the user, in degrees) and finds the difference between this calculated misorientation angle distribution and the theoretical random distribution. For detail on the theory see section \ref{sec:indicies} and \cite{Skemer}, for a detailed breakdown of the \texttt{m\_{}indexDisc} code see appendix APPENDIX.                                            

All three index functions are designed consistently, e.g. if given a VPSC input file they will return the strain of each step as well as the index calculated (to allow easy plotting of the index-strain relationship). At the request of the user, output can be dumped to a text file with headers describing metadata (e.g. input file, index calculated etc.).                                                                                                                    

\begin{table}[h!] 
	\centering
	\caption[Functions: index calculation]{Functions to calculate the various indices, and internal functions within them (that still have use as standalone tools).}
	\noindent
	
\begin{tabularx}{\textwidth}{lX}

\hline
\hline
Function    & Description   \\ 
\hline
\hline
\texttt{j\_{}index}$^{\dagger}$ & Calculates the J-index using elements of the \texttt{MTEX} package. \\ 

\texttt{m\_{}indexCont}$^{\dagger}$ & Calculates the continuous version of the M-index using elements of \texttt{MTEX} package. \\

\texttt{m\_{}indexDisc}$^{\dagger}$ & Calculates the discrete version of the M-index. \\

\texttt{discreteMDF} & Finds the misorientation angle distribution for a given dataset and crystal symmetry. For use in \texttt{m\_{}indexDisc}. \\

\texttt{calDisorientation} & Finds the minimum angle needed to rotate one crystal onto the other, given a crystal symmetry (for use in \texttt{discreteMDF}). \\
\\
\hline
\hline

\end{tabularx}
\label{tab:index_functions}
\end{table}

\subsection{Analysis functions}

I wrote a number of functions to aid further analysis of the texture indices and add functionality to the toolkit (directory \lq{}analysis\rq{} on disc, see table \ref{tab:analysis_functions}). The function \texttt{index\_{}repeat} will calculate any of the indices described in the previous section a specified number of times, sampling with replacement. For example, if the input was a VPSC file with 10,000 grains in each strain step, the J-index could be calculated 50 times, subsampling a different $n$ grains each time (sampling with replacement). This is useful in analysing the variability of each index and how this changes as calculation parameters are varied (see SEC REF).  As with the other \texttt{index} functions, \texttt{index\_{}repeat} can output to file.

The function \texttt{read\_{}texout} reads in the output files from the \texttt{index} functions. This is useful as the output of data to disk allows separation of generating the data (which can take many hours for large index calculations), and creating figures from the data.

One of the objectives of this study was to determine whether the indices are a good proxy for strain. Assuming there is a relationship between the two, it is possible to convert an index value to a strain value. I wrote \texttt{get\_{}strain} to take an index as input, usually calculated from EBSD data (where strain is not known), and find a value for strain by comparing this value to an appropriate index reference curve calculated for VPSC data (where strain is known, or can be interpolated, for any index value). This is essentially a way of estimating strain for an EBSD input data set.

Need section about calculating anisotropy

\begin{table}[h!] 
	\centering
	\caption[Functions: analysis]{List of functions used to analyse the index calculations, either by reading in output files for further calculations, or aiding statistical analysis.}
	\noindent
	
\begin{tabularx}{\textwidth}{lX}

\hline
\hline
Function    & Description   \\ 
\hline
\hline
\texttt{index\_{}repeat}$^{\dagger}$ & Will calculate any of the above indices a number of times (for a specific strain step), using a different seed to resample the data each time (\emph{with} replacement). \\

\texttt{read\_{}texout} & Will read data files output by all \texttt{index} functions. \\
\hline

\end{tabularx}
\label{tab:analysis_functions}
\end{table}

\subsection{Software development and use}

While developing the software for this project, a number of scientific programming practices were followed --- namely those outlined by REF. For example, each function contains documentation on its usage that can be accessed through the \texttt{Matlab} function \texttt{help}. In addition there are appropriate references to the literature, detailed comments and clear variable names to make it easy as possible to follow the code and reasoning behind the algorithms. In addition, version control software \texttt{Github} was used to track the development of the code. This allows for future users to see the development through time, as well as giving a platform for distribution (https://github.com/ee12lmb/matlabSource).


As stated previously, all functions have been developed with consistent syntax in their use. Listing \ref{lst:calcIndices} demonstrates the simplicity with which the three \texttt{index} functions can be used to calculate the indices using a VPSC input data file in the \texttt{Matlab} environment.

\begin{program}[htbp] 
   \centering
   \begin{lstlisting}
% initialise MTEX and add paths to relevant functions
setup_env;   
   
% store file path to VPSC data
VPSC = '~/project/data/olivine_axial_compress_VPSC_big/TEX_PH1.OUT';

% call discrete M-index function and output to file
[ m_disc , strain ] = m_indexDisc(VPSC,1000,1,'crystal','olivine',...
                                'bin',1,'outfile','~/m_disc.out');

% call continuous M-index function and output to file
% don't require strain as it was retrieved by previous function
m_cont = m_indexCont(VPSC,1000,1,'crystal','olivine',...
                                        'outfile','~/m_cont.out');

% call J-index function and output to file
j = j_index(VPSC,1000,1,'crystal','olivine','outfile','~/j_ind.out');


 \end{lstlisting}
   \caption{Snippet of code to calculate the discrete M-index, continuous M-index and J-index using a VPSC input data file. All indices are calculated for the same 1000 grains, using olivine symmetry, with the output file names given after the \lq{}outfile\rq{} flag. The discrete M-index is calculated with a bin width of 1$^\circ$.}
   \label{lst:calcIndices}
\end{program}

Although built for use in the \texttt{Matlab} environment, most analysis was run in batches from the command line, with the data output to file which would then be read in via \texttt{read\_{}texout} in a post-processing script and figures generated. Figure REF shows the general data processing structure, from input data file through to figure output, that is used to form most of the various analysis in the next section.

Some elements of the code were optimised when it became apparent that significant computational time was being wasted due to inefficiencies. For example, the time taken to read in a data file using \texttt{read\_{}VPSC} would increase exponentially as more strain steps were added to the VPSC file. Due to the exceptionally large data files (e.g. 10,000 grains per strain increment, with 26 increments gives 260,000 grains total), it was necessary to modify the code so that the read time increased linearly (see ** APPENDIX REF **). 

%---------------------------FIG---------------------------------------------   
\begin{figure}[th]
  \centering
    \includegraphics[width=0.9\textwidth]{analysis_workflow}
  \caption[Typical analysis workflow]{Typical analysis workflow. Dark grey boxes indicate general steps and light grey gives examples. The general calculations were always run via shell scripts for two reasons 1) it is easier to check over the inputs to ensure they are correct/re-run the analysis if necessary and 2) the calculations could be run across the university servers rather than one-by-one on an individual instance of \texttt{Matlab}, greatly increasing efficiency.}
  \label{fig:analysis_workflow}
\end{figure}
%---------------------------FIG---------------------------------------------   



%\begin{table}[p!] 
%	\centering
%	\caption[VPSC datasets]{List of functions main functions with general descriptions. For more exhaustive documentation see in-function comments/appendices.}
%	\noindent
%	
%\begin{tabularx}{\textwidth}{lX}
%
%\hline
%\hline
%Function    & Description   \\ 
%\hline
%\hline
%
%\texttt{setup\_{}env} & Function initialises the \texttt{MTEX} package and adds paths to all other functions. Stores a global variable to indicate this has been completed (to prevent this occurring at each separate function call). \\  
%
%\texttt{read\_{}VPSC} & Will extract Euler angles and strain information from VPSC files, if output in Bunge convention. If multiple strain steps are present their information will be stored in a cell array (edited from original code by Dr Andrew Walker). \\ 
%
%\texttt{sample\_{}VPSC} & Loads data using \texttt{read\_{}VPSC} and then returns $n$ randomly sampled grains (without replacement). \\  
%
%\texttt{read\_{}EBSD} & Similar to \texttt{read\_{}VPSC}, but reads in EBSD files (*.ctf format). \\
%
%\texttt{sample\_{}EBSD} & Similal to \texttt{sample\_{}VPSC} but for EBSD files (*.ctf format). \\ 
%\\
%\hline
%\hline
%
%\texttt{j\_{}index}$^{\dagger}$ & Calculates the J-index using elements of the \texttt{MTEX} package. \\ 
%
%\texttt{m\_{}indexCont}$^{\dagger}$ & Calculates the continuous version of the M-index using elements of \texttt{MTEX} package. \\
%
%\texttt{m\_{}indexDisc}$^{\dagger}$ & Calculates the discrete version of the M-index. \\
%
%\texttt{discreteMDF} & Finds the misorientation angle distribution for a given dataset and crystal symmetry. For use in \texttt{m\_{}indexDisc}. \\
%
%\texttt{calDisorientation} & Finds the minimum angle needed to rotate one crystal onto the other, given a crystal symmetry (for use in \texttt{discreteMDF}). \\
%\\
%\hline
%\hline
%
%\texttt{index\_{}repeat}$^{\dagger}$ & Will calculate any of the above indices a number of times (for a specific strain step), using a different seed to resample the data each time (\emph{with} replacement). \\
%
%\texttt{read\_{}texout} & Will read data files output by all \texttt{index} functions. \\
%\hline
%& \footnotesize{$^\dagger$ \textit{Functions can take EBSD or VPSC files as input, and sample $n$ grains randomly without replacement for index calculation.}} \\
%
%\end{tabularx}
%\label{tab:functions}
%\end{table}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Analysis} \label{chap:analysis}
\vspace{-1cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
I have broken down the assessment of the texture indices in this project into two broad sections. By their definition it is expected the indices will be sensitive to strain, however it is first important to establish whether other parameters inherent in their calculation, such as the number of grains used, will affect their ouput \emph{(robustness)}. The aim is to determine what is necessary to find the \lq{}true\rq{}, or most accurate, index value of a given sample. I compare my results with those from the literature, particularly of \cite{Skemer} as their motivation for creating the M-index was to provide a more robust measure of texture strength. After determining what criteria need to be met to produce an accurate index value, I present analysis of the relationship between strain and the indices \emph{(proxy for strain)} with confidence that the values presented are accurate and representative of the given sample/model. I studied the robustness of the indices and their use as a proxy for strain using VPSC models and EBSD data from field samples (see section \ref{sec:data}). As such, results for both are included in each section to support any conclusions from two independent data sources and to validate conclusions for field data. I chose the results presented here to best represent the numerous analyses conducted, but provide appendix references to additional results when necessary.       


%---------------------------------------------------------------------------
\section{Index robustness}
%---------------------------------------------------------------------------
In the following section I aim to thoroughly analyse all aspects of index calculation. This includes the number of grains required, the effect of bin size on the discrete M-index, and the general variability and distribution of the indices for subsamples of the same texture. 

\subsection{Number of grains}

One of the first aspects to consider when calculating any texture index is the number of grains that will be used. An index might be considered robust if its value is independent of the number of grains input in the calculation (i.e. an index value calculated using 1,000 grains from a texture would be similar to the same index calculated using 100 grains from the same texture). However, an index will never be completely independent of the number of grains, but would be expected to converge to a certain value past a threshold. This is clear as a larger number of grains will be more representative of the texture as a whole, allowing for a more accurate index calculation. To analyse this, I calculated each index using a range of $n$ for a number of strain steps in an olivine VPSC model undergoing axial compression (Figure \ref{fig:OLV_AXC_n_conv}). 

%---------------------------FIG---------------------------------------------   
\begin{figure}[bht]
  \centering
    \includegraphics[width=\textwidth]{figs/OLV_AXC_Conv_INTERP}
  \caption[Convergence with no. grains (olivine VPSC)]{Convergence plots for J-index, continuous M-index and discrete M-index calculated for an olivine VPSC model undergoing axial compression. The panels show increasing strain steps with (a) 2\%, (b) 16\%,(c) 30\% and (d) 42\% strain. Each data point is the avaerage of 50 calculations, with $n$ randomly sampled grains from a total of 10,000 (sampled with replacement). Calculations were ran for $n$ = 5, 10, 50, 100, 200, 500, 1,000, 2,000, 5,000 and 10,000. Error bars are from the standard deviation of these 50 measurements. All indices show convergence to constant values for calculations that use approximately 1000 grains and above, with standard deviation decreasing rapidly as the number of grains is increased.}
  \label{fig:OLV_AXC_n_conv}
\end{figure}
%---------------------------FIG---------------------------------------------   


As expected, all indices show convergence as the number of grains used in their calculation increases. Both the J-index and the continuous M-index converge smoothly at similar rates, as they are both calculated statistically (section \ref{sec:index_calc}). At very low numbers of grains ($<$50) the discrete M-index value is many times greater than the converged value. This is inherent in the calculation of this index as it requires enough data to construct a histogram to represent the misorientation angle distribution of the texture, which will not be possible with low numbers of grains. Although the value is initially far from the converged value, the discrete M-index has a much higher rate of convergence that the other indices. This is similar to findings of \cite{Skemer} in that convergence is rapid, although they find this occurs at smaller numbers of grains. In contrast to \cite{Skemer}, this effect is more pronounced at higher strain rates, which can be seen when comparing (a) with (d) in figure \ref{fig:OLV_AXC_n_conv} (the discrete M-index curve has levelled at lower $n$ in (d)), although these data are calculated from a VPSC model and not EBSD data as in \cite{Skemer}.

%---------------------------FIG---------------------------------------------   
\begin{figure}[t!]
  \centering
    \includegraphics[width=\textwidth]{figs/EBSD_QTZ_n_Conv.pdf}
  \caption[Convergence with no. of grains (quartz EBSD)]{}
  \label{fig:EBSD_QTZ_n_conv}
\end{figure}
%---------------------------FIG---------------------------------------------   

In order to allow for this comparison, I repeated this calculation for a number of quartz EBSD samples (figure \ref{fig:EBSD_QTZ_n_conv}, see section \ref{sec:data} for details on EBSD data). It is clear that the behaviour of the indices is very similar as $n$ is increased in this case, with all indices converging as low as $n = 500$. This supports the approximate threshold found using olivine VPSC data, using both real field data as well as crystals with  different symmetry. These results still differ from \cite{Skemer} who cite convergence as low as $n = 150$. 

      
%---------------------------FIG---------------------------------------------   
\begin{figure}[h!]
  \centering
    \includegraphics[width=\textwidth]{figs/OLV_AXC_std_conv_INTERP}
  \caption[Index error with no. grains (olivine)]{Relationship between index standard deviation and number of grains used for index calculation, for an olivine VPSC model undergoing axial compression. The data points are the standard deviation of 50 calculations, with $n$ randomly sampled grains for each calculation sampled with replacement from a VPSC model of 10,000 grains total. Calculations were ran for $n$ = 5, 10, 50, 100, 200, 500, 1,000, 2,000, 5,000 and 10,000. The panels show increasing strain with (a) 2\%, (b) 16\%, (c) 30\% and (d) 42\%. }
  \label{fig:OLV_AXC_n_conv_err}
\end{figure}
%---------------------------FIG---------------------------------------------


Having established how the indices converge it is also useful to know how the variability of each index will change with $n$, to give some idea of error bounds on individual calculations. To determine this, the I calculated the indices 50 times for each value of $n$. For example, the data point for the continuous M-index at $n = 100$ grains was calculated 50 times, sub-sampling from a total of 10,000 grains (with replacement). The error bars on figures \ref{fig:OLV_AXC_n_conv} and \ref{fig:EBSD_QTZ_n_conv} are from the standard deviation $(\sigma)$ of these 50 calculations (with the plotted data point being the mean).

To further analyse this, $\sigma$ as a function of $n$ can be seen in figure \ref{fig:OLV_AXC_n_conv_err}. There is a clear trend of decreasing $\sigma$ as the number of grains is increased, although the benefit of increasing $n$ is reduced past approximately 1,000 grains, as $\sigma$ converges to zero (for all indices). This compliments the convergence threshold in that at $n >$ 1,000 all indices have converged to a \lq{}true\rq{} value, with the addition of the error being within acceptable bounds. The discrete M-index shows an anomalous drop in $\sigma$ at $n = 5$. This is again due to the need for enough grains to form a representative histogram of the misorientation distribution, and therefore when this distribution is so poorly defined the index will tend to produce similarly \lq{}wrong\rq{} values and so a smaller standard deviation will result.

\subsection{Bin size (discrete M-index)}

Having established the number of grains $n$ that is necessary for index convergence as approximately $n \geq O(10^{3})$, I can investigate other calculation parameters independently of any effect of $n$, by ensuring all calculations are within this convergent regime. 

When observing the convergence of the continuous and discrete M-index curves for olivine (axial compression) in figure \ref{fig:OLV_AXC_n_conv} it is clear that the discrete M-index consistently converges to a value greater than that of the continuous M-index. Similar behaviour is seen in the quartz EBSD data for pole figures 1, 4 and 9, although not for 7 (figure \ref{fig:EBSD_QTZ_n_conv}). A calculation parameter that can potentially alter the converged (with respect to $n$) value of the M-index is the bin width of the histogram that makes up the misorientation angle distribution.   

%---------------------------FIG---------------------------------------------   
\begin{figure}[b!]
  \centering
    \includegraphics[width=\textwidth]{figs/OLV_AXC_bin_conv.pdf}
  \caption[Convergence with bin size (olivine)]{M-index convergence as bin size is decreased. The data are from analysis of an olivine VPSC model which has undergone axial compression. Each data point was calculated using the same 2,0000 grains, to ensure the indices calculated have converged (in terms of number of grains, see Fig. \ref{fig:OLV_AXC_n_conv}). Panels show increasing strain, with (a) 2\%, (b) 16\%, (c) 30\% and (d) 42\%. The grey line is the continuous M-index calculated for the same 2,000 grains for reference.}
  \label{fig:OLV_AXC_b_conv}
\end{figure}  
%---------------------------FIG---------------------------------------------   

I calculated the discrete M-index for bin sizes ranging from 3$^\circ$ to 0.25$^\circ$ in 0.25$^\circ$ increments for olivine VPSC model undergoing axial compression, using $n$ = 2,000 grains (Figure \ref{fig:OLV_AXC_b_conv}, continuous M-index shown for reference). It is evident that bin size has a significant effect on the value of the discrete M-index, as at all strain steps the value is much greater at a bin size of 3$^\circ$ than at 0.25$^\circ$ (in some cases approximately double), and decreasing bin size results in convergence towards the continuous value. If increasing the number of grains gives more information about the texture, then decreasing the bin size offers better resolution of this information (in terms of the misorientation angle distribution), and so this relationship is expected. Essentially a larger bin size results in a coarser representation of the misorientation angle distribution (figure \ref{fig:OLV_bin_size_example}). This of course makes a smaller bin size preferable, and in the discrete M-index method there is no real penalty in terms of calculation time as misorentation angles for \emph{all} pairs are grains are calculated regardless of bin size. The only difference is the histograms that are subtracted (both the theoretical random distribution, and the calculated distribution as the bin widths must be equal to allow subtraction, see full listing in appendix \ref{App:M-index_calc} for more detail).

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=\textwidth]{figs/OLV_Bin_Size_Example.pdf}
  \caption[Bin size example (olivine VPSC)]{Misorientation angle distribution for olivine VPSC model undergoing axial compression, $n$ = 2,000, strain = 40\%. Panel \textbf{(a)} shows the distribution with a bin size of 3$^\circ$ and panel \textbf{(b)} shows the same distribution with a 0.5$^\circ$ bin size. The density of bins in panel (b) makes visualisation difficult. However, it is clear that the larger bin size in (a) is a much coarser representation of the distribution.}
  \label{fig:OLV_bin_size_example}
\end{figure}  
%---------------------------FIG---------------------------------------------   


Although smaller bin sizes are preferable, there is a functional limit as to how small bin sizes can be. An example would be that if a bin size of $\theta_{bin}$ = 0.5$^\circ$ is used to calculate the M-index for an olivine VPSC model, the number of bins $b_n$ would be:

\begin{equation}
b_n\ =\ \frac{\theta_{max}}{\theta_{bin}}\ =\ \frac{120^\circ}{0.5^\circ}\ =\ 240\ . 
\end{equation}     
\noindent
As each grain is compared to all others around it, the number of pairs of grains $p_n$ (and therefore the number of misorientation angles) is given by:

\begin{equation}
p_n\ =\ \sum^{n-1}_{i=1}(n - i)\ =\ \frac{n}{2}(n-1)\ ,
\end{equation} 
\noindent
giving the absolute minimum value of $n$ to allow at least one misorientation angle to lie in each bin to be $n$ = 23 (see APPENDIX). In reality this is an extreme lower bound as having a single angle in each bin will never represent the misorientation angle of the distribution of a sample with enough accuracy to produce a meaningful index value. However this demonstrates that, especially when small numbers of grains are available, care must be taken when choosing bin width. 

Returning to figure \ref{fig:OLV_AXC_b_conv}, even at at bin size of 0.25$^\circ$ the discrete M-index does not fully converge to the continuous value (panel (a) shows some evidence of convergence \emph{above} the continuous value). One explanation for this is the inherent differences in their calculation. The continuous M-index is calculated from a \emph{misorientation} distribution function that is in turn calculated statistically from an \emph{orientation} distribution function. This ODF inherently undergoes some level of smoothing in its calculation from the orientation data \citep[e.g. regularisation when inverting for the ODF in the \texttt{MTEX} algorithm, see][]{Hielscher2008}. Any smoothing will reduce the \lq{}sharpness\rq{} of this function and so the continuous M-index will tend to be lower than the discrete M-index (which has no smoothing factors in its calculation). This is because the ODF, and hence the MDF, describe the texture as a whole (section \ref{subsec:ODFs}). Essentially a smoother ODF will dampen a stronger texture to appear weaker, and hence a lower index value will result. 

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=0.8\textwidth]{figs/OLV_SPS_cont_disc_diff.pdf}
  \caption[Discrete and continuous M-index difference (olivine VPSC)]{The difference between the continuous and discrete M-index calculated for an olivine VPSC model undergoing simple shear. Values are the average of 50 calculations using $n$ = 2,000 grains sampled with replacement from a total of 10,000. Error bars are the standard deviation of the indices. \textbf{Inset} shows a clearer picture of the average difference between the 50 calculations of both indices, with the same axes as the main plot. The difference is on a similar order to the actual values showing that, although the change is small, the increase in difference with strain is not negligible.}
  \label{fig:OLV_SPS_cont_disc_diff}
\end{figure}  
%---------------------------FIG---------------------------------------------   

If the discrepancy is larger for stronger textures, then the difference between the two M-indices would become larger as strain increases (assuming stronger texture results from greater strain). To determine this, I created curves of the discrete and continuous M-index as a function of strain, calculated for an olivine VPSC model undergoing simple shear (Figure \ref{fig:OLV_SPS_cont_disc_diff}). Before considering the difference between the curves, it is clear visually that they diverge as strain is increased, with the discrete M-index giving increasingly larger index values compared to the continuous. The difference curve on the main plot shows that this change is small in comparison to the index values, although not negligible, with the inset giving a clearer picture of this relationship. This divergence, although small, supports that the smoothing of the continuous M-index is the source of the discrepancy between the two methods of calculation. Figure \ref{fig:OLV_SPS_cont_disc_diff} also shows a small increase in error (standard deviation) as strain is increased. 

\subsection{Index variability and distribution}

In the following section I am to investigate the increase of standard deviation with strain, as observed in Figure \ref{fig:OLV_SPS_cont_disc_diff}. To accomplish this I calculated all three indices 1,000 times (using \texttt{index\_repeat}) for multiple strain steps in an olivine VPSC model undergoing axial compression, as well as a number of EBSD datasets, using $n$ = 1,000 grains. Figure \ref{fig:VPSC_md_dist} shows histograms of the discrete M-index values for the olivine axial compression VPSC model (centred on zero by subtracting the mean from all values, for ease of comparison). It is clear that the variability of the discrete M-index increases considerably with strain. This result was consistent across all indices, for both the VPSC and EBSD data (see appendix figure REF).

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=0.9\textwidth]{figs/MD_VPSC_n1000_distribution.pdf}
  \caption[Discrete M-index distribution (olivine VPSC)]{Distribution of discrete M-index values. Histograms are composed from 1,000 calculations using $n$ = 1,000 grains (larger $n$ would require excessive compute time) from an olivine VPSC model undergoing axial compression. The distributions have been centred on zero by subtracting the mean from all values to allow for easier comparison between strain steps. It is clear the spread in index values becomes greater as strain increases.}
  \label{fig:VPSC_md_dist}
\end{figure} 
%---------------------------FIG---------------------------------------------  

One explanation arises when considering the the movement of individual grains within the sample. The rotation rate of a grain within a sample at a given time is related to its current orientation. If the imposed stress field is aligned with a weaker slip system within that grain, its rotation rate will be greater than one whose slip systems are out of line. As a result, the alignment of grains on the whole will increase (and therefore the strength of the texture), but some grains will remain in their more \lq{}random\rq{} orientation for longer. Hence taking a random sample of 1,000 grains will sometimes capture those that have, on average, become more aligned (giving a greater index value) and sometimes those that would represent a more random texture (and hence a lower index value), resulting in greater variability. In contrast, if \emph{all} grains are randomly orientated, then taking a sample of 1,000 should consistently return an equally low index.     


%---------------------------------------------------------------------------
\section{Proxy for strain}
%---------------------------------------------------------------------------

Now that I have determined the robustness and variability of the indices, I move on in the following section to analyse their relationship with strain and whether they are an appropriate proxy. Once this relationship is established, I use it to estimate the strain of EBSD data. I analyse the seismic anisotropy measures introduced in section REF, and determine the relationship, if any, between these and the indices.   


Include bit about dynamic recrystallisation

\subsection{Index-strain relationship}

To gain an understanding of the indices relationship with strain, I calculated each index for VPSC models of olivine, quartz and post-perovskite, undergoing both axial compression (strain range 2 - 50\%) and simple shear (strain range 8.75 - 350\%), using $n$ = 5,000 grains (figure \ref{fig:indices_vs_strain}).     

%---------------------------FIG---------------------------------------------   
\begin{figure*}[p]
  \centering
    \includegraphics[width=\textwidth]{figs/ALL_6panel_plot.pdf}
  \caption[Relation of indices to strain (VPSC)]{Relationship between the J-index, continuous M-index and discrete M-index to sample strain. Data are from VPSC models, with the indices calculated using the same 5,000 grains at each strain step (this many grains ensures the results are in the convergent regime). Discrete M-index calculated with a bin size of 0.25$^\circ$. \textbf{Top row} shows data for olivine, \textbf{middle row} shows quartz and \textbf{bottom row} shows post-perovskite (P-PS). \textbf{Left column} shows data from an axial compression VPSC model, the \textbf{right column} shows data from a simple shear VPSC model. Note the change of scale on both y-axes in \textbf{f}. Applying these scales to other plots reduces clarity --- consistent scales on all other plots (within each column) allows for useful comparison (see text).}
  \label{fig:indices_vs_strain}
\end{figure*} 
%---------------------------FIG---------------------------------------------  

It is clear that for both olivine and post-perovskite, the indices increase monotonically with strain. For both crystals, the indices increase relatively linearly to approximately 100 - 150\% strain, after which the behaviour of the two crystals diverges. The J-index for olivine simple shear (panel (b)) continues to increase linearly to a value of $J_O$ = 24.26 at 350\% strain, whereas the J-index for post-perovskite is less linear, and increases to a much greater value of $J_P$ = 86.49. The gradients of the M-index curves for both olivine and post-perovskite simple shear (panels (b) and (f)) decrease past 150\% strain and they begin to tend towards constant values, although both M-indices are much greater for post-perovskite (approximately double). The behaviour is more linear in the lower strain limit of the axial compression curves (50\%), although the post-perovskite M-index values are again approximately double. The similarity in index behaviour for these two minerals (compared to quartz) is likely due to them having the same crystal symmetry (REF?).

Continue on to talk about pps deformation mechanisms, citing Walker 2012. Following this, talk about the quartz anomaly and the likely explanation.      


%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=\textwidth]{figs/QTZ_Strain_Zoom.pdf}
  \caption[Relation of indices to strain (quartz VPSC)]{Relationship between the indices and strain for quartz VPSC, calculated using the same 5,000 grains, with a bin size of 0.25$^\circ$ used for the discrete M-index calculation. Panels \textbf{(a)} and \textbf{(b)} use the same data as panels (c) and (d) in figure \ref{fig:indices_vs_strain}, with different scales to allow clearer analysis. In particular the strain axes for the simple shear VPSC has been restricted to 50\% (denser data points were used to ensure the curves are smooth and well defined). It is clear the discrete M-index does not follow the continuous M-index at low strains, and in fact increases as strain decreases below approximately 20\%.}
  \label{fig:indices_vs_strain_qtz}
\end{figure} 
%---------------------------FIG---------------------------------------------  

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=\textwidth]{figs/QTZ_AXC_n500_misor_dist.pdf}
  \caption[Misorientation angle distribution (quartz VPSC)]{Misorientation angle distributions for a quartz VPSC model undergoing axial compression, calculated using the same 500 grains with a bin width of 1$^{\circ}$ ** maybe need more grains and smaller bin **. The panels show increasing strain with \textbf{(a)} XX, \textbf{(b)} XX, \textbf{(c)} XX and \textbf{(d)} XX. The solid line shows the theoretical misorientation distribution for a random fabric of quartz grains.} 
  \label{fig:qtz_misorientation_dist}
\end{figure} 
%---------------------------FIG---------------------------------------------

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=\textwidth]{figs/m_vs_j.pdf}
  \caption[Relationship of M- and J-indices]{} 
  \label{fig:m_vs_j}
\end{figure} 
%---------------------------FIG---------------------------------------------  
  

\subsection{Estimating strain}

%---------------------------FIG---------------------------------------------   
\begin{figure}[h]
  \centering
    \includegraphics[width=\textwidth]{figs/EBSD_ind-strain.pdf}
  \caption[Relationship of indices to strain (quartz EBSD)]{} 
  \label{fig:indices_vs_strain_qtz_EBSD}
\end{figure} 
%---------------------------FIG---------------------------------------------  

\subsection{Relation to seismic anisotropy}
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Discussion} \label{chap:discussion}
\vspace{-1cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Comparison of results}

\section{Future work}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusion} \label{chap:conclusion}
\vspace{-1cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{leedsHarvard}
\bibliography{../dissertation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\chapter{Appendix}
%\vspace{-1cm}
\newpage
\appendix
\renewcommand{\thesection}{\Roman{section}}
\chapter{Appendices}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Calculating the discrete M-index} \label{App:M-index_calc}
The contents...

\section{Listings of significant functions}

%\newpage
\section{Additional analysis figures}
%---------------------------FIG---------------------------------------------   
This appendix contains figures that support much of the analysis and discussion in the main body. These figures have been omitted as similar conclusions can be drawn from figures in the text that were chosen to best illustrate the points made there. 

\begin{figure}[h]
  \centering
    \includegraphics[width=\textwidth]{figs/EBSD_QTZ_n500_misor_dist.pdf}
  \caption[Misorientation angle distribution (quartz EBSD)]{Misorientation angle distributions for quartz EBSD data, calculated using the same 500 grains with a bin width of 1$^{\circ}$ ** maybe need more grains and smaller bin **. The panels show increasing strain with \textbf{(a)} XX, \textbf{(b)} XX, \textbf{(c)} XX and \textbf{(d)} XX. The solid line shows the theoretical misorientation distribution for a random fabric of quartz grains. } 
  \label{fig:APP_misor_dist_qtz_ebsd}
\end{figure} 
%---------------------------FIG--
\end{document}
